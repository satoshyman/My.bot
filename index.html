<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TON Cloud Mining</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --ton-color: #0088cc; --bg: #0a0b10; --card: #161b22; }
        body { background: var(--bg); color: white; font-family: 'Cairo', sans-serif; margin: 0; padding: 0; text-align: center; }
        .header { padding: 20px; background: var(--card); border-bottom: 2px solid #21262d; position: sticky; top: 0; z-index: 100; }
        .ton-logo { width: 120px; filter: drop-shadow(0 0 15px var(--ton-color)); margin: 15px 0; }
        .balance { font-size: 32px; font-weight: bold; color: var(--ton-color); margin: 10px 0; }
        .page { display: none; padding: 20px 15px 100px; }
        .page.active { display: block; }
        .card { background: var(--card); border-radius: 15px; padding: 15px; margin-bottom: 15px; border: 1px solid #30363d; text-align: right; }
        .btn { background: var(--ton-color); color: white; border: none; padding: 12px 20px; border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer; transition: 0.3s; }
        .btn:disabled { background: #333; cursor: not-allowed; }
        .nav { position: fixed; bottom: 0; width: 100%; background: var(--card); display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #30363d; }
        .nav-item { color: #8b949e; font-size: 12px; cursor: pointer; }
        .nav-item.active { color: var(--ton-color); }
        .wheel-container { position: relative; width: 200px; height: 200px; margin: 20px auto; border: 5px solid var(--ton-color); border-radius: 50%; }
    </style>
</head>
<body>

    <div class="header">
        <img src="https://ton.org/download/ton_symbol.png" class="ton-logo">
        <div class="balance"><span id="user-bal">0.00000</span> TON</div>
        <div style="font-size: 12px; color: #8b949e;">Ø§Ù„Ø®Ø·Ø©: <span id="plan-name">Ù…Ø¬Ø§Ù†ÙŠØ©</span></div>
    </div>

    <div id="mining" class="page active">
        <div class="card">
            <h3>Ø§Ù„ØªØ¹Ø¯ÙŠÙ† Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ â›ï¸</h3>
            <p id="timer" style="font-size: 24px; text-align: center; color: var(--ton-color);">Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø¯Ø¡</p>
            <button class="btn" id="mine-btn" onclick="startMining()">Ø¥Ø¨Ø¯Ø£ Ø§Ù„ØªØ¹Ø¯ÙŠÙ† (ÙƒÙ„ 6 Ø³Ø§Ø¹Ø§Øª)</button>
        </div>
        <div class="card">
            <p>â€¢ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©: 1 TON ÙƒÙ„ 8 Ø£ÙŠØ§Ù…</p>
            <p>â€¢ Ø§Ù„Ø±Ø¨Ø­ ÙÙŠ Ø§Ù„Ø¬Ù„Ø³Ø©: 0.03125 TON</p>
        </div>
    </div>

    <div id="wallet" class="page">
        <div class="card">
            <h3>Ø§Ù„Ø³Ø­Ø¨ ğŸ’³</h3>
            <p>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰: 1 TON</p>
            <button class="btn" onclick="withdraw()">Ø·Ù„Ø¨ Ø³Ø­Ø¨</button>
        </div>
        <div class="card">
            <h3>Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø© ğŸ‘¥</h3>
            <p>Ø§ÙƒØ³Ø¨ 0.0001 TON Ø¹Ù† ÙƒÙ„ ØµØ¯ÙŠÙ‚</p>
            <button class="btn" onclick="copyRef()">Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</button>
        </div>
    </div>

    <div id="shop" class="page">
        <h3>ØªØ±Ù‚ÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨ ğŸš€</h3>
        <div class="card">
            <h4>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1 (1$)</h4>
            <p>ÙŠØµÙ„ Ù„Ù„Ø³Ø­Ø¨ ÙÙŠ 6 Ø£ÙŠØ§Ù…</p>
            <button class="btn" onclick="upgrade(1, 1)">Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¢Ù†</button>
        </div>
        <div class="card">
            <h4>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2 (3$)</h4>
            <p>ÙŠØµÙ„ Ù„Ù„Ø³Ø­Ø¨ ÙÙŠ 4 Ø£ÙŠØ§Ù…</p>
            <button class="btn" onclick="upgrade(3, 2)">Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¢Ù†</button>
        </div>
        <div class="card">
            <h4>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3 (5$)</h4>
            <p>ÙŠØµÙ„ Ù„Ù„Ø³Ø­Ø¨ ÙÙŠ ÙŠÙˆÙ…ÙŠÙ† ÙˆØ±Ø¨Ø¹</p>
            <button class="btn" onclick="upgrade(5, 3)">Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¢Ù†</button>
        </div>
    </div>

    <div id="extra" class="page">
        <div class="card">
            <h3>Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸ ğŸ¡</h3>
            <button class="btn" id="spin-btn" onclick="spinWheel()">Ù„Ù Ø§Ù„Ø¹Ø¬Ù„Ø© (ÙŠÙˆÙ…ÙŠ)</button>
        </div>
        <div class="card">
            <h3>Ù…Ù‡Ø§Ù… Ø³Ø±ÙŠØ¹Ø© âœ…</h3>
            <p>Ø§Ø´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø© (+0.00001 TON)</p>
            <button class="btn" onclick="doTask('https://t.me/YourChannel', 0.00001)">ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù‡Ù…Ø©</button>
        </div>
    </div>

    <nav class="nav">
        <div class="nav-item active" onclick="showP('mining', this)"><i class="fas fa-hammer"></i><br>ØªØ¹Ø¯ÙŠÙ†</div>
        <div class="nav-item" onclick="showP('wallet', this)"><i class="fas fa-wallet"></i><br>Ù…Ø­ÙØ¸Ø©</div>
        <div class="nav-item" onclick="showP('shop', this)"><i class="fas fa-rocket"></i><br>ØªØ±Ù‚ÙŠØ©</div>
        <div class="nav-item" onclick="showP('extra', this)"><i class="fas fa-star"></i><br>Ø¥Ø¶Ø§ÙØ§Øª</div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let bal = parseFloat(localStorage.getItem('ton_bal')) || 0;
        let plan = parseInt(localStorage.getItem('plan')) || 0; // 0=Free, 1=Lvl1, 2=Lvl2, 3=Lvl3
        let lastMine = parseInt(localStorage.getItem('last_mine')) || 0;
        let lastSpin = parseInt(localStorage.getItem('last_spin')) || 0;

        const plansInfo = [
            { name: "Ù…Ø¬Ø§Ù†ÙŠØ©", profit: 1/32 }, // 32 Ø¬Ù„Ø³Ø© (8 Ø£ÙŠØ§Ù… * 4) Ù„ØªØµÙ„ Ù„Ù€ 1 TON
            { name: "Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1", profit: 1/24 }, // 24 Ø¬Ù„Ø³Ø© (6 Ø£ÙŠØ§Ù…)
            { name: "Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2", profit: 1/16 }, // 16 Ø¬Ù„Ø³Ø© (4 Ø£ÙŠØ§Ù…)
            { name: "Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3", profit: 1/9 }    // 9 Ø¬Ù„Ø³Ø§Øª (2.25 ÙŠÙˆÙ…)
        ];

        function updateUI() {
            document.getElementById('user-bal').innerText = bal.toFixed(5);
            document.getElementById('plan-name').innerText = plansInfo[plan].name;
            
            const now = Date.now();
            const diff = now - lastMine;
            if (diff < 21600000) { // 6 hours
                document.getElementById('mine-btn').disabled = true;
                startTimer(21600000 - diff);
            } else {
                document.getElementById('mine-btn').disabled = false;
                document.getElementById('timer').innerText = "Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ¹Ø¯ÙŠÙ†";
            }
            
            localStorage.setItem('ton_bal', bal);
            localStorage.setItem('plan', plan);
        }

        function startMining() {
            bal += plansInfo[plan].profit;
            lastMine = Date.now();
            localStorage.setItem('last_mine', lastMine);
            updateUI();
            tg.sendData(JSON.stringify({action: 'sync', bal: bal, plan: plan}));
            tg.showAlert("ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ†! Ø­ØµÙ„Øª Ø¹Ù„Ù‰ " + plansInfo[plan].profit.toFixed(4) + " TON");
        }

        function spinWheel() {
            const now = Date.now();
            if (now - lastSpin < 86400000) return tg.showAlert("Ø¹Ø¯ ØºØ¯Ø§Ù‹ Ù„Ù„Ù Ø§Ù„Ø¹Ø¬Ù„Ø©!");
            
            // Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 0.00001 Ùˆ 0.001
            let win = Math.random() * (0.001 - 0.00001) + 0.00001;
            bal += win;
            lastSpin = now;
            localStorage.setItem('last_spin', lastSpin);
            updateUI();
            tg.showAlert("Ù…Ø¨Ø±ÙˆÙƒ! ÙØ²Øª Ø¨Ù€ " + win.toFixed(5) + " TON");
        }

        function upgrade(price, id) {
            tg.showAlert("ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ø¯ÙØ¹ " + price + "$ ÙˆØªØ±Ù‚ÙŠØ© Ø­Ø³Ø§Ø¨Ùƒ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ " + id);
        }

        function withdraw() {
            if (bal >= 1) tg.showAlert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©.");
            else tg.showAlert("Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ Ù‡Ùˆ 1 TON");
        }

        function doTask(url, reward) {
            window.open(url, '_blank');
            setTimeout(() => {
                bal += reward;
                updateUI();
                tg.showAlert("ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©!");
            }, 5000);
        }

        function startTimer(duration) {
            let timer = duration / 1000;
            let interval = setInterval(() => {
                let h = Math.floor(timer / 3600);
                let m = Math.floor((timer % 3600) / 60);
                let s = Math.floor(timer % 60);
                document.getElementById('timer').innerText = `${h}:${m}:${s}`;
                if (--timer < 0) { clearInterval(interval); updateUI(); }
            }, 1000);
        }

        function showP(id, el) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
        }

        updateUI();
    </script>
</body>
</html>
